const User = require('../models/user');
async function createNewUser(data) {
    const user = new User(data);
    await user.save();
}

async function deleteUserById(id){
    await User.findByIdAndDelete(id);

}

async function getAllUsers(){
    const users = await User.find();
    return users;
}

async function updateUser(id , data) {
    const updatedUser = await User.findByIdAndUpdate(id,data , {new : true});
    return updatedUser;  
}
async function approveUser(id) {
    const user = await User.findByIdAndUpdate(id,{IsApproved:true} , {new : true});
    return user; 
}
async function notApprovedUserList() {
    const users = await User.find({IsApproved : false});
    return users;
}
async function blockUser(id , expiry) {
    const user = await User.findByIdAndUpdate(
        id,
        { IsBlocked: true, blockExpiry: expiry }, 
        
        { new: true }
    );
    return user;
}
async function findUserById(id) {
    const user = await User.findById(id); 
    return user;
}

async function findUserWithRoleAndList(usersIdsList , role) {
    const users = await User.find({ _id: { $in: usersIdsList }, role:role }); 

    return users;
}

module.exports = {findUserById , blockUser , notApprovedUserList 
    , approveUser , updateUser , getAllUsers , deleteUserById , createNewUser , findUserWithRoleAndList };


                     

                               

                             